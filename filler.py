# [



#   {
#     "rank": 32,
#     "title": "Oppenheimer",
#     "description": "The story of American scientist, J. Robert Oppenheimer, and his role in the development of the atomic bomb.",
#     "image": "https://m.media-amazon.com/images/M/MV5BMDBmYTZjNjUtN2M1MS00MTQ2LTk2ODgtNzc2M2QyZGE5NTVjXkEyXkFqcGdeQXVyNzAwMjU2MTY@._V1_QL75_UX380_CR0,0,380,562_.jpg",
#     "big_image": "https://m.media-amazon.com/images/M/MV5BMDBmYTZjNjUtN2M1MS00MTQ2LTk2ODgtNzc2M2QyZGE5NTVjXkEyXkFqcGdeQXVyNzAwMjU2MTY@._V1_QL75_UX380_CR0,0,380,562_.jpg",
#     "genre": [
#       "Biography",
#       "Drama",
#       "History"
#     ],
#     "thumbnail": "https://m.media-amazon.com/images/M/MV5BMDBmYTZjNjUtN2M1MS00MTQ2LTk2ODgtNzc2M2QyZGE5NTVjXkEyXkFqcGdeQXVyNzAwMjU2MTY@._V1_UY67_CR0,0,45,67_AL_.jpg",
#     "rating": "8.6",
#     "id": "top32",
#     "year": 2023,
#     "imdbid": "tt15398776",
#     "imdb_link": "https://www.imdb.com/title/tt15398776"
#   },
#   {
#     "rank": 33,
#     "title": "Harakiri",
#     "description": "When a ronin requesting seppuku at a feudal lord's palace is told of the brutal suicide of another ronin who previously visited, he reveals how their pasts are intertwined - and in doing so challenges the clan's integrity.",
#     "image": "https://m.media-amazon.com/images/M/MV5BYjBmYTQ1NjItZWU5MS00YjI0LTg2OTYtYmFkN2JkMmNiNWVkXkEyXkFqcGdeQXVyMTMxMTY0OTQ@._V1_QL75_UY562_CR17,0,380,562_.jpg",
#     "big_image": "https://m.media-amazon.com/images/M/MV5BYjBmYTQ1NjItZWU5MS00YjI0LTg2OTYtYmFkN2JkMmNiNWVkXkEyXkFqcGdeQXVyMTMxMTY0OTQ@._V1_QL75_UY562_CR17,0,380,562_.jpg",
#     "genre": [
#       "Action",
#       "Drama",
#       "Mystery"
#     ],
#     "thumbnail": "https://m.media-amazon.com/images/M/MV5BYjBmYTQ1NjItZWU5MS00YjI0LTg2OTYtYmFkN2JkMmNiNWVkXkEyXkFqcGdeQXVyMTMxMTY0OTQ@._V1_UY67_CR2,0,45,67_AL_.jpg",
#     "rating": "8.6",
#     "id": "top33",
#     "year": 1962,
#     "imdbid": "tt0056058",
#     "imdb_link": "https://www.imdb.com/title/tt0056058"
#   },
#   {
#     "rank": 34,
#     "title": "Back to the Future",
#     "description": "Marty McFly, a 17-year-old high school student, is accidentally sent 30 years into the past in a time-traveling DeLorean invented by his close friend, the maverick scientist Doc Brown.",
#     "image": "https://m.media-amazon.com/images/M/MV5BZmU0M2Y1OGUtZjIxNi00ZjBkLTg1MjgtOWIyNThiZWIwYjRiXkEyXkFqcGdeQXVyMTQxNzMzNDI@._V1_QL75_UX380_CR0,14,380,562_.jpg",
#     "big_image": "https://m.media-amazon.com/images/M/MV5BZmU0M2Y1OGUtZjIxNi00ZjBkLTg1MjgtOWIyNThiZWIwYjRiXkEyXkFqcGdeQXVyMTQxNzMzNDI@._V1_QL75_UX380_CR0,14,380,562_.jpg",
#     "genre": [
#       "Adventure",
#       "Comedy",
#       "Sci-Fi"
#     ],
#     "thumbnail": "https://m.media-amazon.com/images/M/MV5BZmU0M2Y1OGUtZjIxNi00ZjBkLTg1MjgtOWIyNThiZWIwYjRiXkEyXkFqcGdeQXVyMTQxNzMzNDI@._V1_UX45_CR0,0,45,67_AL_.jpg",
#     "rating": "8.5",
#     "id": "top34",
#     "year": 1985,
#     "imdbid": "tt0088763",
#     "imdb_link": "https://www.imdb.com/title/tt0088763"
#   },
#   {
#     "rank": 35,
#     "title": "The Pianist",
#     "description": "A Polish Jewish musician struggles to survive the destruction of the Warsaw ghetto of World War II.",
#     "image": "https://m.media-amazon.com/images/M/MV5BOWRiZDIxZjktMTA1NC00MDQ2LWEzMjUtMTliZmY3NjQ3ODJiXkEyXkFqcGdeQXVyNjU0OTQ0OTY@._V1_QL75_UY562_CR14,0,380,562_.jpg",
#     "big_image": "https://m.media-amazon.com/images/M/MV5BOWRiZDIxZjktMTA1NC00MDQ2LWEzMjUtMTliZmY3NjQ3ODJiXkEyXkFqcGdeQXVyNjU0OTQ0OTY@._V1_QL75_UY562_CR14,0,380,562_.jpg",
#     "genre": [
#       "Biography",
#       "Drama",
#       "Music"
#     ],
#     "thumbnail": "https://m.media-amazon.com/images/M/MV5BOWRiZDIxZjktMTA1NC00MDQ2LWEzMjUtMTliZmY3NjQ3ODJiXkEyXkFqcGdeQXVyNjU0OTQ0OTY@._V1_UY67_CR2,0,45,67_AL_.jpg",
#     "rating": "8.5",
#     "id": "top35",
#     "year": 2002,
#     "imdbid": "tt0253474",
#     "imdb_link": "https://www.imdb.com/title/tt0253474"
#   }
# ]


import requests
import json
import sqlite3
import tabulate

connecting = sqlite3.connect('database.db')

cursor = connecting.cursor()

url = "https://imdb-top-100-movies.p.rapidapi.com/"

headers = {
	"X-RapidAPI-Key": "1113510abdmsh56e6d650501d95cp16362cjsna8b95bb20f0e",
	"X-RapidAPI-Host": "imdb-top-100-movies.p.rapidapi.com"
}

response = requests.get(url, headers=headers)
movies = response.json()

for movie in movies:
    print(movie.get('title', 'Unknown'))

    name  = movie.get('title', 'Unknown')
    genre = movie.get('genre', 'Unknown')[0]
    year = movie.get('year', 'Unknown')
    description = movie.get('description', 'Unknown')
    rating = float(movie.get('rating', 'Unknown'))
    

    name = name.replace('"', "'")
    genre = genre.replace('"', "'")
    description = description.replace('"', "'")

    cursor.execute(
        f'INSERT INTO movie (name, genre, year, description, rating) VALUES("{name}", "{genre}", {year}, "{description}", {rating})'

    )
    connecting.commit()

print(response.json())
with open ('movies.json', 'w') as file:
    file.write(json.dumps(response.json(), indent = 4))


cinemas = [
    {
        'name': 'Eurasia Cinema 7',
        'adress': 'ул.Северная 17'

    },
    
    {
        'name': 'Chaplin cinemas',
        'adress': '​Хан Шатыр​Проспект Туран, 37'

    },
    
    {
        'name': 'Арман',
        'adress': '​Проспект Кабанбай батыр, 21'

    },
    {
        'name': 'Kinopark ',
        'adress': 'ТРЦ Сарыарка​Проспект Туран, 24'

    },
    {
        'name': 'Eurasia Cinema 7',
        'adress': 'ул.Северная 17'

    },

]

# for cinema in cinemas:
#     name = cinema.get('name', 'Unknown')
#     adress = cinema.get('adress', 'Unknown')

#     cursor.execute(
#         f'INSERT INTO cinema (name, address) VALUES("{name}", "{adress}")'
#         )
#     connecting.commit()

import datetime
import random



# afishas = [
#     {
#         'movie_id': 1,
#         'cinema_id':1,
#         'price':1000,
#         'date': '2022-01-01',
#         'time':'10:00:00',
#         'capacity':100
#     }
# ]
# start_date = datetime.date.today()
# end_date = datetime.date(2024, 5,30)


# start_time = datetime.time(16,0,0)
# end_time = datetime.time(0,0,0)
# movies_id = [random.randint(1,100) for i in range(1,51)]
# cinemas_id = [random.randint(1,5) for i in range(1,51)]
# prices = [random.randint(1000,5000) for i in range(1,51)]

# gap = int((end_date - start_date).total_seconds())

# dates = [start_date + datetime.timedelta(seconds=random.randint(0,gap)) for i in range(1,51)]

# times = [f"{random.randint(16,23)}:{random.randint(0,5)}0:00" for i in range(1,51)]

# capacities = [random.randint(50,100) for i in range(1,51)]

# for i in range(0,50):
#     cursor.execute(
#         f'INSERT INTO afisha (movie_id,cinema_id ,price , date, time, capacity) VALUES("{movies_id[i]}", "{cinemas_id[i]}", {prices[i]}, "{dates[i]}", "{times[i]}", {capacities[i]})'
#     )
#     connecting.commit()

# afisha_id
# room
# row
# seat


# afishas = [i for i in range(1,51)]
# rooms = [random.randint(1,16) for i in range(1,51)]
# row = [random.randint(1,16) for i in range(1,51)]
# columns = [random.randint(1,16) for i in range(1,51)]

# for i in range(0,50):
#     cursor.execute(
#         f"INSERT INTO place (afisha_id, room, row, seat) VALUES ({afishas[i]}, {rooms[i]}, {row[i]}, {columns[i]})"
#     )
#     connecting.commit()